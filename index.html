<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GIHS Term 1 2026 Cubing Competition - Full Results</title>
    <style>
        body { font-family: -apple-system, sans-serif; background: #0f1220; color: #fff; padding: 20px; }
        h2 { text-align: center; color: #3b85f5; margin-bottom: 25px; }
        h3 { text-align: center; color: #aaa; margin-top: 30px; border-bottom: 1px solid #333; padding-bottom: 10px; }
        #nav-bar { margin: 15px 0; display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; }
        .nav-group { display: flex; align-items: center; gap: 5px; background: #1a1d2b; padding: 10px 18px; border-radius: 8px; border: 1px solid #3b85f5; }
        table { border-collapse: collapse; width: 100%; max-width: 1200px; margin: 0 auto 40px auto; background: #1a1d2b; border-radius: 8px; overflow: hidden; }
        th, td { border: 1px solid #333; padding: 10px; text-align: center; position: relative; }
        th { background: #252a40; color: #aaa; font-size: 10px; text-transform: uppercase; letter-spacing: 1px; }
        .solver-link, .round-link { color: #3b85f5; text-decoration: underline; cursor: pointer; font-weight: bold; }
        .solver-link:hover, .round-link:hover { color: #fff; }
        #modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1000; justify-content: center; align-items: center; }
        #profile-modal { background: #0f1220; width: 95%; max-width: 1100px; max-height: 85vh; overflow-y: auto; padding: 25px; border-radius: 12px; border: 1px solid #3b85f5; position: relative; }
        .close-modal { position: absolute; top: 15px; right: 20px; font-size: 28px; cursor: pointer; color: #888; }
        .bubble { position: absolute; top: 2px; right: 2px; padding: 2px 6px; border-radius: 4px; font-size: 11px; font-weight: bold; }
        .pr-bubble { background: #3b85f5; color: white; } .sr-bubble { background: #28a745; color: white; }
        .rank-green { background: #28a745 !important; color: white; font-weight: bold; }
        .solve-best { color: #2ecc71 !important; font-weight: bold; }
        .solve-worst { color: #e74c3c !important; font-weight: bold; }
        select { padding: 8px 14px; background: #0f1220; color: #fff; border: 1px solid #444; border-radius: 4px; cursor: pointer; font-weight: bold; }
        #pdf-btn { background: #3b85f5; color: white; border: none; padding: 12px 30px; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 16px; box-shadow: 0 4px 15px rgba(59, 133, 245, 0.3); }
        
        @media screen {
            .interactive-view { display: block; }
            .print-view { display: none !important; }
        }

        @media print {
            @page { size: auto; margin: 10mm; }
            body { background: white !important; color: black !important; padding: 0; }
            .no-print, #pdf-btn, #nav-bar, #interactive-container { display: none !important; }
            .print-view { display: block !important; }
            .page-break { page-break-before: always; }
            table { background: white !important; width: 100% !important; border: 1px solid #000 !important; page-break-inside: avoid; }
            th { background: #eee !important; color: black !important; border: 1px solid #000 !important; }
            td { border: 1px solid #000 !important; color: black !important; }
            h2, h3 { color: black !important; border-bottom: 2px solid black !important; }
            .rank-green { background: #dfd !important; color: black !important; }
            .solve-best { color: #008000 !important; font-weight: bold !important; }
            .pr-bubble, .sr-bubble { border: 1px solid black !important; color: black !important; position: static !important; display: inline-block; margin-left: 5px; }
            .round-link { color: black !important; text-decoration: none !important; cursor: default !important; }
        }
    </style>
</head>
<body>
    <div class="no-print" style="text-align:center">
        <h2>GIHS Term 1 2026 Cubing Competition</h2>
        <button id="pdf-btn" onclick="window.print()">Print All Rounds to PDF</button>
        <p style="font-size: 12px; color: #666; margin-top: 15px;">Note: Dropdowns below are for digital browsing. "Print" will capture ALL rounds automatically.</p>
    </div>
    <div id="nav-bar" class="no-print"></div>
    <div id="interactive-container" class="no-print"></div>
    <div id="print-container" class="print-view"></div>
    <div id="modal-overlay" onclick="closeProfile()">
        <div id="profile-modal" onclick="event.stopPropagation()">
            <span class="close-modal" onclick="closeProfile()">&times;</span>
            <h2 id="modal-name">SOLVER PROFILE</h2>
            <div id="medal-container" class="medal-box" style="display:flex; justify-content:center; gap:10px; margin-bottom:20px;"></div>
            <div id="modal-content"></div>
        </div>
    </div>
    <script>
        const state = {"title":"GIHS Term 1 2026 Cubing Competition","events":{"3x3":{"parent":null,"rows":[]},"3x3 - First Round":{"parent":"3x3","rows":[{"name":"Jeremy Arulampalam","solves":["21.169","17.943","16.900","22.249","20.104"],"green":true},{"name":"Sebastian Cook","solves":["24.812","21.764","20.796","16.746","20.721"],"green":true},{"name":"Xavier Ouano","solves":["22.441","44.967+++","27.275","24.912","22.814"],"green":true},{"name":"Zephram Cochrane","solves":["28.589","24.792","26.176","33.077","27.258"],"green":true},{"name":"Isaac Tran","solves":["DNF","28.749","30.416","29.597","25.054"],"green":true},{"name":"Pranav Kumaraguru","solves":["28.374","31.176","26.148","32.769","29.861"],"green":true},{"name":"Jiani Yang","solves":["39.302","43.659","27.037","31.746","32.216"],"green":false},{"name":"Anish Mangla","solves":["38.804+","45.507","55.103","36.044","34.089"],"green":false,"aRec":"PR"},{"name":"Chloe Ma","solves":["1:02.585","1:18.155","1:02.305","1:04.053","59.071"],"green":false,"aRec":"PR"},{"name":"Ethan Ho","solves":["1:00.502","1:12.013","DNF","56.056","58.846"],"green":false,"aRec":"PR","bRec":"PR"},{"name":"Raeva Bothra","solves":["1:32.744","1:24.203","42.302","1:29.563","1:12.264"],"green":false,"bRec":"PR","aRec":null},{"name":"Thomas Barone","solves":["","","","",""],"green":false}]},"2x2":{"parent":null,"rows":[]},"2x2 - First Round":{"parent":"2x2","rows":[{"name":"Jeremy Arulampalam","solves":["4.190","6.972","5.416","4.930","6.233"],"green":true},{"name":"Sebastian Cook","solves":["9.176","6.332","5.638","5.342","4.804"],"green":true},{"name":"Pranav Kumaraguru","solves":["8.917","5.935","6.607","3.926","8.614"],"green":true,"bRec":"PR"},{"name":"Isaac Tran","solves":["8.488","8.129","7.239","9.321","9.131"],"green":false},{"name":"Xavier Ouano","solves":["8.881","7.562+","10.519","10.446","7.982+"],"green":false},{"name":"Anish Mangla","solves":["12.082+","10.738","13.248","10.136","7.670"],"green":false},{"name":"Jiani Yang","solves":["24.950","24.196","23.832","12.038","18.827"],"green":false},{"name":"Raeva Bothra","solves":["20.502","14.891","34.961","21.966","38.323"],"green":false,"bRec":"PR","aRec":null},{"name":"Gregory Hor","solves":["","","","",""],"green":false},{"name":"Thomas Barone","solves":["","","","",""],"green":false}]},"1x3x3":{"parent":null,"rows":[]},"1x3x3 - First Round":{"parent":"1x3x3","rows":[{"name":"Jeremy Arulampalam","solves":["12.658","10.597","15.318","14.136","7.136"],"green":true,"bRec":"SR","aRec":"SR"},{"name":"Anish Mangla","solves":["24.403","14.795","22.285","15.101","16.870"],"green":true,"bRec":"PR","aRec":"PR"},{"name":"Sebastian Cook","solves":["28.426","10.995","15.059","23.496","22.714"],"green":true,"bRec":"PR","aRec":"PR"},{"name":"Jiani Yang","solves":["23.681","28.034","25.755","18.575","16.674"],"green":false,"bRec":"PR","aRec":"PR"},{"name":"Xavier Ouano","solves":["DNF","33.653","19.620","11.752","18.311"],"green":false,"aRec":"PR","bRec":"PR"},{"name":"Ethan Ho","solves":["32.452","15.846","1:05.298","1:43.393","29.463"],"green":false,"bRec":"PR","aRec":"PR"},{"name":"Raeva Bothra","solves":["","","","",""],"green":false},{"name":"Gregory Hor","solves":["","","","",""],"green":false}]},"4x4":{"parent":null,"rows":[]},"4x4 - Final":{"parent":"4x4","rows":[{"name":"Sebastian Cook","solves":["1:08.667","1:15.889","1:17.004","1:08.394","1:04.665"],"green":true},{"name":"Jeremy Arulampalam","solves":["1:13.102","1:16.502","1:06.103","1:14.466","1:05.213"],"green":true,"aRec":"PR"},{"name":"Xavier Ouano","solves":["2:01.995","1:35.075","1:49.422","2:20.657","1:40.034"],"green":true},{"name":"Anish Mangla","solves":["2:42.723","2:57.168","3:48.831","3:05.783","DNF"],"green":false,"aRec":"PR","bRec":"PR"},{"name":"Jiani Yang","solves":["3:10.153","3:32.599","","",""],"green":false,"bRec":"PR"}]},"5x5":{"parent":null,"rows":[]},"5x5 - Final":{"parent":"5x5","rows":[{"name":"Sebastian Cook","solves":["2:47.503","2:06.675","2:38.108","2:30.549","2:16.772"],"green":true},{"name":"Jeremy Arulampalam","solves":["2:27.333","2:51.547","2:28.606","2:29.474","2:54.978"],"green":true,"aRec":"PR"},{"name":"Thomas Barone","solves":["","","","",""],"green":true}]},"3x3 - Second Round":{"parent":"3x3","rows":[]},"3x3 - Final":{"parent":"3x3","rows":[]},"2x2 - Final":{"parent":"2x2","rows":[]},"1x3x3 - Final":{"parent":"1x3x3","rows":[]},"Pyraminx":{"parent":null,"rows":[]},"Pyraminx - Final":{"parent":"Pyraminx","rows":[]},"Megaminx":{"parent":null,"rows":[]},"Megaminx - Final":{"parent":"Megaminx","rows":[]},"Skewb":{"parent":null,"rows":[]},"Skewb - Final":{"parent":"Skewb","rows":[]},"Mirror Cube":{"parent":null,"rows":[]},"Mirror Cube - Final":{"parent":"Mirror Cube","rows":[]},"3x3 OH":{"parent":null,"rows":[]},"3x3 OH - Final":{"parent":"3x3 OH","rows":[{"name":"Jeremy Arulampalam","solves":["44.084","54.035","48.913","41.109","DNF"],"green":true},{"name":"Sebastian Cook","solves":["1:14.535","58.708","1:24.075","51.965","1:02.970"],"green":true},{"name":"Xavier Ouano","solves":["\n","","","",""],"green":true},{"name":"Chloe Ma","solves":["","","","",""],"green":false}]}}};
        let activeKey = null;
        function parseTime(str) {
    if (!str || str.trim() === "") return null;
    let clean = str.replace(/\[.*?\]/g, '').trim().toLowerCase();
    if (clean === 'dnf' || clean === 'â€”' || clean === '-') return Infinity;
    if (clean.includes(':')) {
        let p = clean.split(':');
        return (parseFloat(p[0]) * 60) + parseFloat(p[1]);
    }
    return isNaN(parseFloat(clean)) ? null : parseFloat(clean);
}
        function formatTime(val) {
    if (val === Infinity) return 'DNF';
    if (val === null || isNaN(val)) return 'â€”';
    if (val >= 60) {
        let m = Math.floor(val / 60);
        let s = (val % 60).toFixed(3);
        return `${m}:${s < 10 ? '0' : ''}${s}`;
    }
    return val.toFixed(3);
}
        function getAverage(solves) {
    let t = solves.map(parseTime).filter(x => x !== null);
    if (t.length < 5) return null;
    if (t.filter(x => x === Infinity).length >= 2) return Infinity;
    let s = [...t].sort((a,b) => a - b);
    return (s[1] + s[2] + s[3]) / 3;
}
        function getSortScore(solves) {
    let t = solves.map(parseTime).filter(x => x !== null);
    if (t.length === 0) return 30000;
    let avg = getAverage(solves);
    if (avg !== null && avg !== Infinity) return avg;
    let best = Math.min(...t);
    if (best !== Infinity) return 10000 + best;
    return 20000;
}
        function showProfile(name) {
    document.getElementById('modal-name').textContent = name.toUpperCase();
    let content = `<table><thead><tr><th>Event</th><th>Round</th><th>Rank</th><th>S1</th><th>S2</th><th>S3</th><th>S4</th><th>S5</th><th>Best</th><th>Average</th></tr></thead><tbody>`;
    let found = false;
    let medals = { gold: 0, silver: 0, bronze: 0 };
    for (let key in state.events) {
        let sheet = state.events[key];
        if (!sheet.parent) continue;
        let sorted = [...sheet.rows].sort((a,b) => getSortScore(a.solves) - getSortScore(b.solves));
        let idx = sorted.findIndex(r => r.name === name);
        if (idx !== -1) {
            found = true;
            let p = sorted[idx];
            let tp = p.solves.map(parseTime);
            let bV = Math.min(...tp.filter(x => x !== null && x !== Infinity));
            if (idx === 0) medals.gold++; else if (idx === 1) medals.silver++; else if (idx === 2) medals.bronze++;
            
            content += `<tr><td>${sheet.parent}</td><td><span class="round-link" onclick="goToRound('${key.replace(/'/g, "\\'")}')">${key.split(' - ')[1]}</span></td>
                <td class="${p.green ? 'rank-green' : ''}">${idx+1}</td>
                ${p.solves.map(s => `<td>${s||'â€”'}</td>`).join('')}<td>${formatTime(bV)}</td><td>${formatTime(getAverage(p.solves))}</td></tr>`;
        }
    }
    document.getElementById('medal-container').innerHTML = `<div class="medal gold">ðŸ¥‡ ${medals.gold}</div><div class="medal silver">ðŸ¥ˆ ${medals.silver}</div><div class="medal bronze">ðŸ¥‰ ${medals.bronze}</div>`;
    content += `</tbody></table>`;
    document.getElementById('modal-content').innerHTML = found ? content : `<div class="empty-msg">No history.</div>`;
    document.getElementById('modal-overlay').style.display = 'flex';
}
        function goToRound(key) { closeProfile(); render(key); }
        function closeProfile() { document.getElementById('modal-overlay').style.display = 'none'; }
        function goToRound(key) { closeProfile(); renderInteractive(key); }
        function generateTableHTML(key, isPrint = false) {
            const sheet = state.events[key];
            if(!sheet || !sheet.parent) return '';
            const rows = [...sheet.rows].sort((a,b) => getSortScore(a.solves) - getSortScore(b.solves));
            let html = '<div class="' + (isPrint ? 'page-break' : '') + '">';
            html += '<h3>' + sheet.parent + ' - ' + key.split(' - ')[1] + '</h3>';
            html += '<table><thead><tr><th>Rank</th><th>Name</th><th>S1</th><th>S2</th><th>S3</th><th>S4</th><th>S5</th><th>Best</th><th>Average</th></tr></thead><tbody>';
            rows.forEach((r, i) => {
                let tp = r.solves.map(parseTime);
                let bV = tp.filter(x => x !== null && x !== Infinity).length > 0 ? Math.min(...tp.filter(x => x !== null && x !== Infinity)) : (tp.includes(Infinity) ? Infinity : null);
                let wV = tp.filter(x => x !== null).length > 0 ? Math.max(...tp.filter(x => x !== null)) : null;
                html += '<tr><td class="'+(r.green?'rank-green':'')+'">'+(i+1)+'</td>';
                html += '<td style="text-align:left; padding-left:15px;"><span class="solver-link" onclick="showProfile(\''+r.name.replace(/'/g, "\\'")+'\')">'+r.name+'</span></td>';
                r.solves.forEach((s) => {
                    let p = parseTime(s);
                    let cls = (p !== null && p !== Infinity && p === bV) ? "solve-best" : (p !== null && p === wV ? "solve-worst" : "");
                    html += '<td class="'+cls+'">'+(s||'â€”')+'</td>';
                });
                html += '<td>'+formatTime(bV)+(r.bRec?'<span class="bubble '+r.bRec.toLowerCase()+'-bubble">'+r.bRec+'</span>':'')+'</td>';
                html += '<td>'+formatTime(getAverage(r.solves))+(r.aRec?'<span class="bubble '+r.aRec.toLowerCase()+'-bubble">'+r.aRec+'</span>':'')+'</td></tr>';
            });
            html += '</tbody></table></div>';
            return html;
        }
        function renderInteractive(newKey = null) {
            if(newKey) activeKey = newKey;
            const nav = document.getElementById('nav-bar'); nav.innerHTML = '';
            const evs = Object.keys(state.events);
            if(evs.length === 0) return;
            if(!activeKey || !state.events[activeKey]) activeKey = evs.find(k => state.events[k].parent) || evs[0];
            let n1 = document.createElement('div'); n1.className = 'nav-group';
            let sE = document.createElement('select'); 
            evs.filter(k => !state.events[k].parent).forEach(m => { 
                let o = document.createElement('option'); o.value = m; o.textContent = m; 
                if(activeKey === m || state.events[activeKey].parent === m) o.selected = true; 
                sE.appendChild(o); 
            });
            sE.onchange = (e) => renderInteractive(e.target.value); n1.appendChild(sE); nav.appendChild(n1);
            let curP = state.events[activeKey].parent || activeKey;
            let rds = evs.filter(k => state.events[k].parent === curP);
            if(rds.length > 0 || state.events[activeKey].parent) {
                let n2 = document.createElement('div'); n2.className = 'nav-group';
                let sR = document.createElement('select'); 
                sR.insertAdjacentHTML('beforeend', '<option value="'+curP+'">-- Select Round --</option>');
                rds.forEach(r => { 
                    let o = document.createElement('option'); o.value = r; o.textContent = r.split(' - ')[1]; 
                    if(activeKey === r) o.selected = true; sR.appendChild(o); 
                });
                sR.onchange = (e) => renderInteractive(e.target.value); n2.appendChild(sR); nav.appendChild(n2);
            }
            document.getElementById('interactive-container').innerHTML = state.events[activeKey].parent ? generateTableHTML(activeKey, false) : '<div style="text-align:center; padding:50px; color:#555;">Select a sub-round.</div>';
        }
        function init() {
            let printHtml = '';
            Object.keys(state.events).forEach(key => { if(state.events[key].parent) { printHtml += generateTableHTML(key, true); } });
            document.getElementById('print-container').innerHTML = printHtml;
            renderInteractive();
        }
        window.onload = init;
    </script>
</body>
</html>
